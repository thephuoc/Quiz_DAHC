<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>H·ªá Th·ªëng Thi Tr·∫Øc Nghi·ªám - DAHC</title>
    <meta name="description" content="H·ªá th·ªëng thi tr·∫Øc nghi·ªám tr·ª±c tuy·∫øn d√†nh cho nh√¢n vi√™n c√¥ng ty">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/style.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.31/jspdf.plugin.autotable.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <link rel="icon" type="image/svg+xml" href="images/favicon.svg">
</head>

<body>
    <!-- Login Screen -->
    <div id="loginScreen" class="screen active">
        <div class="login-container">
            <!-- Admin Settings Button -->
            <button class="btn-admin-settings" id="btnAdminSettings" title="C√†i ƒë·∫∑t qu·∫£n tr·ªã">
                ‚öôÔ∏è
            </button>

            <!-- History Button -->
            <a href="history.html" class="btn-history" title="Xem l·ªãch s·ª≠ thi & PDF cache"
                style="position:absolute;top:15px;right:60px;width:40px;height:40px;border-radius:50%;background:rgba(255,255,255,0.1);border:none;font-size:18px;cursor:pointer;display:flex;align-items:center;justify-content:center;text-decoration:none;transition:all 0.3s;">
                üìÇ
            </a>

            <div class="login-header">
                <div class="logo-icon">üìù</div>
                <h1>H·ªá Th·ªëng Thi Tr·∫Øc Nghi·ªám</h1>
                <p class="subtitle">ƒêƒÉng nh·∫≠p ƒë·ªÉ b·∫Øt ƒë·∫ßu l√†m b√†i thi</p>
            </div>
            <form id="loginForm" class="login-form">
                <div class="form-group">
                    <label for="fullName">
                        <span class="icon">üë§</span>
                        H·ªç v√† T√™n
                    </label>
                    <select id="fullName" name="fullName" required class="candidate-select">
                        <option value="">-- Ch·ªçn t√™n c·ªßa b·∫°n --</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="birthDate">
                        <span class="icon">üìÖ</span>
                        Ng√†y sinh
                    </label>
                    <div class="date-input-wrapper">
                        <input type="date" id="birthDate" name="birthDate" required>
                        <span id="birthYearDisplay" class="year-display hidden"></span>
                    </div>
                    <span class="input-hint">Ch·ªçn ng√†y v√† th√°ng sinh c·ªßa b·∫°n</span>
                </div>
                <div id="loginError" class="login-error" style="display: none;"></div>
                <button type="submit" class="btn-primary btn-start">
                    <span>B·∫Øt ƒê·∫ßu Thi</span>
                    <span class="icon">‚ñ∂</span>
                </button>
            </form>
        </div>
    </div>

    <!-- Admin Settings Modal -->
    <div id="adminSettingsModal" class="modal-overlay">
        <div class="modal-content admin-settings-modal">
            <div class="modal-header">
                <h2>‚öôÔ∏è C√†i ƒê·∫∑t Qu·∫£n Tr·ªã</h2>
                <button class="modal-close" id="closeAdminModal">&times;</button>
            </div>

            <!-- Password Section -->
            <div id="adminPasswordSection" class="admin-section">
                <div class="form-group">
                    <label for="adminPassword">
                        <span class="icon">üîê</span>
                        M·∫≠t kh·∫©u qu·∫£n tr·ªã
                    </label>
                    <input type="password" id="adminPassword" placeholder="Nh·∫≠p m·∫≠t kh·∫©u">
                    <button class="btn-primary btn-verify" id="btnVerifyPassword">X√°c nh·∫≠n</button>
                </div>
            </div>

            <!-- Settings Section (hidden until password verified) -->
            <div id="adminSettingsSection" class="admin-section" style="display: none;">
                <h3>üìä S·ªë c√¢u h·ªèi theo ph√¢n lo·∫°i</h3>
                <div class="settings-grid">
                    <div class="setting-item">
                        <label for="settingPCCC">1. PCCC</label>
                        <input type="number" id="settingPCCC" min="0" max="100" value="4">
                        <span class="available-count" id="availablePCCC">/64</span>
                    </div>
                    <div class="setting-item">
                        <label for="settingQT_ATD">2. QT_ATD</label>
                        <input type="number" id="settingQT_ATD" min="0" max="100" value="7">
                        <span class="available-count" id="availableQT_ATD">/105</span>
                    </div>
                    <div class="setting-item">
                        <label for="settingATD">3. ATD</label>
                        <input type="number" id="settingATD" min="0" max="100" value="7">
                        <span class="available-count" id="availableATD">/59</span>
                    </div>
                    <div class="setting-item">
                        <label for="settingTBA">4. TBA</label>
                        <input type="number" id="settingTBA" min="0" max="100" value="6">
                        <span class="available-count" id="availableTBA">/61</span>
                    </div>
                    <div class="setting-item">
                        <label for="settingNMD">5. NMD</label>
                        <input type="number" id="settingNMD" min="0" max="100" value="6">
                        <span class="available-count" id="availableNMD">/78</span>
                    </div>
                </div>

                <h3>‚è±Ô∏è C√†i ƒë·∫∑t b√†i thi</h3>
                <div class="settings-grid">
                    <div class="setting-item full-width">
                        <label for="settingTotalQuestions">T·ªïng s·ªë c√¢u h·ªèi</label>
                        <input type="number" id="settingTotalQuestions" min="5" max="100" value="30">
                    </div>
                    <div class="setting-item full-width">
                        <label for="settingDuration">Th·ªùi gian thi (ph√∫t)</label>
                        <input type="number" id="settingDuration" min="5" max="120" value="20">
                    </div>
                </div>

                <div class="modal-buttons">
                    <button class="modal-btn cancel" id="btnCancelSettings">H·ªßy</button>
                    <button class="modal-btn confirm" id="btnSaveSettings">üíæ L∆∞u c√†i ƒë·∫∑t</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Quiz Screen -->
    <div id="quizScreen" class="screen">
        <header class="quiz-header">
            <div class="header-left">
                <span class="exam-icon">üìã</span>
                <span class="exam-code" id="examCode">B√ÄI THI TR·∫ÆC NGHI·ªÜM</span>
            </div>
            <div class="header-center">
                <div class="timer-container">
                    <span class="timer-icon">‚è±</span>
                    <span class="timer" id="timer">20:00</span>
                </div>
            </div>
            <div class="header-right">
                <span class="user-name" id="userName">Th√≠ sinh</span>
                <span class="user-icon">üë§</span>
            </div>
        </header>

        <main class="quiz-main">
            <div class="questions-panel">
                <div class="question-container" id="questionContainer">
                    <!-- Questions will be rendered here -->
                </div>
                <div class="navigation-buttons">
                    <button class="btn-nav btn-prev" id="btnPrev">
                        <span>‚Äπ QUAY L·∫†I</span>
                    </button>
                    <button class="btn-nav btn-next" id="btnNext">
                        <span>TI·∫æP ‚Ä∫</span>
                    </button>
                </div>
            </div>

            <aside class="sidebar">
                <div class="sidebar-header">
                    <h3>B·∫£ng tr·∫°ng th√°i tr·∫£ l·ªùi c√°c c√¢u h·ªèi tr·∫Øc nghi·ªám</h3>
                </div>
                <div class="question-grid" id="questionGrid">
                    <!-- Question numbers will be rendered here -->
                </div>
                <div class="legend">
                    <div class="legend-item">
                        <span class="legend-dot not-visited"></span>
                        <span>Ch∆∞a xem</span>
                    </div>
                    <div class="legend-item">
                        <span class="legend-dot visited"></span>
                        <span>ƒê√£ xem</span>
                    </div>
                    <div class="legend-item">
                        <span class="legend-dot current"></span>
                        <span>Hi·ªán t·∫°i</span>
                    </div>
                    <div class="legend-item">
                        <span class="legend-dot answered"></span>
                        <span>ƒê√£ l√†m</span>
                    </div>
                    <div class="legend-item">
                        <span class="legend-dot flagged"></span>
                        <span>L∆∞u l·∫°i</span>
                    </div>
                </div>
                <button class="btn-finish" id="btnFinish">
                    K·∫æT TH√öC 30 C√ÇU
                </button>
                <div class="sidebar-footer">
                    <p class="warning-text">Trong tr∆∞·ªùng h·ª£p l·ªói m·∫°ng khi n·ªôp b√†i thi, xin b√°o c√°o cho PKT, ho·∫∑c nh·∫•n
                        n√∫t ph√≠a d∆∞·ªõi.</p>
                    <a href="#" class="download-link" id="downloadExam">
                        <span>‚¨á</span> T·∫£i xu·ªëng b√†i thi c·ªßa b·∫°n
                    </a>
                </div>
            </aside>
        </main>
    </div>

    <!-- Result Screen -->
    <div id="resultScreen" class="screen">
        <div class="result-container">
            <div class="result-header">
                <div class="result-icon" id="resultIcon">üéâ</div>
                <h1 id="resultTitle">K·∫øt Qu·∫£ B√†i Thi</h1>
            </div>
            <div class="result-card">
                <div class="user-info-result">
                    <p><strong>H·ªç v√† t√™n:</strong> <span id="resultName"></span></p>
                    <p><strong>Ng√†y sinh:</strong> <span id="resultBirthDate"></span></p>
                    <p><strong>ƒê∆°n v·ªã:</strong> <span id="resultDepartment"></span></p>
                    <p><strong>Ng√†y thi:</strong> <span id="resultDate"></span></p>
                    <p><strong>Th·ªùi gian l√†m b√†i:</strong> <span id="resultDuration"></span></p>
                </div>
                <div class="score-section">
                    <div class="score-circle" id="scoreCircle">
                        <span class="score-number" id="scoreNumber">0</span>
                        <span class="score-total">/30</span>
                    </div>
                    <div class="score-details">
                        <div class="score-item correct">
                            <span class="score-label">S·ªë c√¢u ƒë√∫ng:</span>
                            <span class="score-value" id="correctCount">0</span>
                        </div>
                        <div class="score-item wrong">
                            <span class="score-label">S·ªë c√¢u sai:</span>
                            <span class="score-value" id="wrongCount">0</span>
                        </div>
                    </div>
                </div>
                <div class="result-status" id="resultStatus">
                    <!-- PASS or FAIL will be shown here -->
                </div>
            </div>
            <div class="result-actions">
                <button class="btn-primary btn-export" id="btnExportPDF">
                    <span class="icon">üìÑ</span>
                    <span>Xu·∫•t PDF</span>
                </button>
                <button class="btn-secondary btn-retry" id="btnRetry">
                    <span class="icon">üîÑ</span>
                    <span>L√†m l·∫°i</span>
                </button>
            </div>
        </div>
    </div>

    <script src="js/candidates.js"></script>
    <script src="js/questions.js"></script>
    <script src="js/admin.js"></script>
    <script src="js/app.js"></script>
</body>

</html>